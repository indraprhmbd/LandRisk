generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           String   @id @default(uuid())
  kindeId      String   @unique
  email        String   @unique
  name         String?
  givenName    String?
  familyName   String?
  picture      String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  parcels      Parcel[]
}

model Parcel {
  id                   String   @id @default(uuid())
  location_name        String
  latitude             Float
  longitude            Float
  land_area            Float
  zoning_category      String

  soil_index           Float
  flood_index          Float
  environmental_index  Float
  zoning_index         Float
  topography_index     Float

  data_completeness    Float
  model_consistency    Float
  data_recency         Float

  last_updated         DateTime
  data_source_label    String

  // Caching & Source Tracking
  is_offline_mode      Boolean  @default(false)
  api_cache_timestamp  DateTime @default(now())
  
  // User tracking
  userId               String?
  user                 User?    @relation(fields: [userId], references: [id], onDelete: SetNull)

  created_at           DateTime @default(now())

  @@index([latitude, longitude])
  @@index([userId])
}
